{"version":3,"sources":["node_modules/remarkable/lib/rules_core/footnote_tail.js"],"names":["module","exports","footnote_block","state","i","l","j","t","lastParagraph","list","tokens","current","currentLabel","level","insideRef","refTokens","env","footnotes","filter","tok","type","label","push","length","id","tight","content","children","concat","pop","count","subId"],"mappings":"AAAA;;AAGAA,OAAOC,OAAP,GAAiB,SAASC,cAAT,CAAwBC,KAAxB,EAA+B;AAC9C,MAAIC,CAAJ;AAAA,MAAOC,CAAP;AAAA,MAAUC,CAAV;AAAA,MAAaC,CAAb;AAAA,MAAgBC,aAAhB;AAAA,MAA+BC,IAA/B;AAAA,MAAqCC,MAArC;AAAA,MAA6CC,OAA7C;AAAA,MAAsDC,YAAtD;AAAA,MACIC,QAAQ,CADZ;AAAA,MAEIC,YAAY,KAFhB;AAAA,MAGIC,YAAY,EAHhB;;AAKA,MAAI,CAACZ,MAAMa,GAAN,CAAUC,SAAf,EAA0B;AAAE;AAAS;;AAErCd,QAAMO,MAAN,GAAeP,MAAMO,MAAN,CAAaQ,MAAb,CAAoB,UAASC,GAAT,EAAc;AAC/C,QAAIA,IAAIC,IAAJ,KAAa,yBAAjB,EAA4C;AAC1CN,kBAAY,IAAZ;AACAH,gBAAU,EAAV;AACAC,qBAAeO,IAAIE,KAAnB;AACA,aAAO,KAAP;AACD;AACD,QAAIF,IAAIC,IAAJ,KAAa,0BAAjB,EAA6C;AAC3CN,kBAAY,KAAZ;AACA;AACAC,gBAAU,MAAMH,YAAhB,IAAgCD,OAAhC;AACA,aAAO,KAAP;AACD;AACD,QAAIG,SAAJ,EAAe;AAAEH,cAAQW,IAAR,CAAaH,GAAb;AAAoB;AACrC,WAAO,CAACL,SAAR;AACD,GAfc,CAAf;;AAiBA,MAAI,CAACX,MAAMa,GAAN,CAAUC,SAAV,CAAoBR,IAAzB,EAA+B;AAAE;AAAS;AAC1CA,SAAON,MAAMa,GAAN,CAAUC,SAAV,CAAoBR,IAA3B;;AAEAN,QAAMO,MAAN,CAAaY,IAAb,CAAkB;AAChBF,UAAM,qBADU;AAEhBP,WAAOA;AAFS,GAAlB;AAIA,OAAKT,IAAI,CAAJ,EAAOC,IAAII,KAAKc,MAArB,EAA6BnB,IAAIC,CAAjC,EAAoCD,GAApC,EAAyC;AACvCD,UAAMO,MAAN,CAAaY,IAAb,CAAkB;AAChBF,YAAM,eADU;AAEhBI,UAAIpB,CAFY;AAGhBS,aAAOA;AAHS,KAAlB;;AAMA,QAAIJ,KAAKL,CAAL,EAAQM,MAAZ,EAAoB;AAClBA,eAAS,EAAT;AACAA,aAAOY,IAAP,CAAY;AACVF,cAAM,gBADI;AAEVK,eAAO,KAFG;AAGVZ,eAAOA;AAHG,OAAZ;AAKAH,aAAOY,IAAP,CAAY;AACVF,cAAM,QADI;AAEVM,iBAAS,EAFC;AAGVb,eAAOA,KAHG;AAIVc,kBAAUlB,KAAKL,CAAL,EAAQM;AAJR,OAAZ;AAMAA,aAAOY,IAAP,CAAY;AACVF,cAAM,iBADI;AAEVK,eAAO,KAFG;AAGVZ,eAAO,EAAEA;AAHC,OAAZ;AAKD,KAlBD,MAkBO,IAAIJ,KAAKL,CAAL,EAAQiB,KAAZ,EAAmB;AACxBX,eAASK,UAAU,MAAMN,KAAKL,CAAL,EAAQiB,KAAxB,CAAT;AACD;;AAEDlB,UAAMO,MAAN,GAAeP,MAAMO,MAAN,CAAakB,MAAb,CAAoBlB,MAApB,CAAf;AACA,QAAIP,MAAMO,MAAN,CAAaP,MAAMO,MAAN,CAAaa,MAAb,GAAsB,CAAnC,EAAsCH,IAAtC,KAA+C,iBAAnD,EAAsE;AACpEZ,sBAAgBL,MAAMO,MAAN,CAAamB,GAAb,EAAhB;AACD,KAFD,MAEO;AACLrB,sBAAgB,IAAhB;AACD;;AAEDD,QAAIE,KAAKL,CAAL,EAAQ0B,KAAR,GAAgB,CAAhB,GAAoBrB,KAAKL,CAAL,EAAQ0B,KAA5B,GAAoC,CAAxC;AACA,SAAKxB,IAAI,CAAT,EAAYA,IAAIC,CAAhB,EAAmBD,GAAnB,EAAwB;AACtBH,YAAMO,MAAN,CAAaY,IAAb,CAAkB;AAChBF,cAAM,iBADU;AAEhBI,YAAIpB,CAFY;AAGhB2B,eAAOzB,CAHS;AAIhBO,eAAOA;AAJS,OAAlB;AAMD;;AAED,QAAIL,aAAJ,EAAmB;AACjBL,YAAMO,MAAN,CAAaY,IAAb,CAAkBd,aAAlB;AACD;;AAEDL,UAAMO,MAAN,CAAaY,IAAb,CAAkB;AAChBF,YAAM,gBADU;AAEhBP,aAAO,EAAEA;AAFO,KAAlB;AAID;AACDV,QAAMO,MAAN,CAAaY,IAAb,CAAkB;AAChBF,UAAM,sBADU;AAEhBP,WAAO,EAAEA;AAFO,GAAlB;AAID,CA3FD","file":"footnote_tail.js","sourceRoot":"/Users/liangdong06/work/react-tools","sourcesContent":["'use strict';\n\n\nmodule.exports = function footnote_block(state) {\n  var i, l, j, t, lastParagraph, list, tokens, current, currentLabel,\n      level = 0,\n      insideRef = false,\n      refTokens = {};\n\n  if (!state.env.footnotes) { return; }\n\n  state.tokens = state.tokens.filter(function(tok) {\n    if (tok.type === 'footnote_reference_open') {\n      insideRef = true;\n      current = [];\n      currentLabel = tok.label;\n      return false;\n    }\n    if (tok.type === 'footnote_reference_close') {\n      insideRef = false;\n      // prepend ':' to avoid conflict with Object.prototype members\n      refTokens[':' + currentLabel] = current;\n      return false;\n    }\n    if (insideRef) { current.push(tok); }\n    return !insideRef;\n  });\n\n  if (!state.env.footnotes.list) { return; }\n  list = state.env.footnotes.list;\n\n  state.tokens.push({\n    type: 'footnote_block_open',\n    level: level++\n  });\n  for (i = 0, l = list.length; i < l; i++) {\n    state.tokens.push({\n      type: 'footnote_open',\n      id: i,\n      level: level++\n    });\n\n    if (list[i].tokens) {\n      tokens = [];\n      tokens.push({\n        type: 'paragraph_open',\n        tight: false,\n        level: level++\n      });\n      tokens.push({\n        type: 'inline',\n        content: '',\n        level: level,\n        children: list[i].tokens\n      });\n      tokens.push({\n        type: 'paragraph_close',\n        tight: false,\n        level: --level\n      });\n    } else if (list[i].label) {\n      tokens = refTokens[':' + list[i].label];\n    }\n\n    state.tokens = state.tokens.concat(tokens);\n    if (state.tokens[state.tokens.length - 1].type === 'paragraph_close') {\n      lastParagraph = state.tokens.pop();\n    } else {\n      lastParagraph = null;\n    }\n\n    t = list[i].count > 0 ? list[i].count : 1;\n    for (j = 0; j < t; j++) {\n      state.tokens.push({\n        type: 'footnote_anchor',\n        id: i,\n        subId: j,\n        level: level\n      });\n    }\n\n    if (lastParagraph) {\n      state.tokens.push(lastParagraph);\n    }\n\n    state.tokens.push({\n      type: 'footnote_close',\n      level: --level\n    });\n  }\n  state.tokens.push({\n    type: 'footnote_block_close',\n    level: --level\n  });\n};\n"]}