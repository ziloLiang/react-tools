{"version":3,"sources":["node_modules/superagent-bluebird-promise/index.js"],"names":["Promise","require","superagent","module","exports","Request","config","cancellation","e","console","warn","join","stack","SuperagentPromiseError","message","originalError","name","Error","captureStackTrace","constructor","Object","defineProperty","get","prototype","promise","req","error","resolve","reject","onCancel","end","err","res","status","msg","method","url","body","abort","then","apply","arguments","catch"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liangdong06/work/react-tools","sourcesContent":["// From https://gist.github.com/epeli/11209665\n\nvar Promise = require(\"bluebird\");\n\n// So you can `var request = require(\"superagent-bluebird-promise\")`\nvar superagent = module.exports = require(\"superagent\");\nvar Request = superagent.Request;\n\ntry {\n  Promise.config({\n    // Enable cancellation.\n    cancellation: true\n  });\n} catch (e) {\n  console.warn([\n    'Enabling bluebird cancellation failed.',\n    'If you are using bluebird elsewhere in your application,',\n    'be sure to enable cancellation there as well.',\n    'Promise.config({cancellation: true});'].join(' ')\n  );\n  console.warn(e.stack);\n}\n// Create custom error type.\n// Create a new object, that prototypally inherits from the Error constructor.\nvar SuperagentPromiseError = function(message, originalError) {\n  var stack;\n  this.message = message;\n  this.name = 'SuperagentPromiseError';\n  this.originalError = originalError;\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n    stack = this.stack;\n  }\n  else {\n    stack = (new Error(message)).stack;\n  }\n\n  if (Object.defineProperty) {\n    Object.defineProperty(this, 'stack', {\n      get: function() {\n        if (this.originalError) {\n          return stack + '\\nCaused by:  ' + this.originalError.stack;\n        }\n\n        return stack;\n      }\n    });\n  }\n};\n\nSuperagentPromiseError.prototype = new Error();\nSuperagentPromiseError.prototype.constructor = SuperagentPromiseError;\nsuperagent.SuperagentPromiseError = SuperagentPromiseError;\n\n/**\n * @namespace utils\n * @class Superagent\n */\n\n/**\n *\n * Add promise support for superagent/supertest\n *\n * Call .promise() to return promise for the request\n *\n * @method then\n * @return {Bluebird.Promise}\n */\nRequest.prototype.promise = function() {\n  var req = this;\n  var error;\n\n  return new Promise(function(resolve, reject, onCancel) {\n      req.end(function(err, res) {\n        if (typeof res !== \"undefined\" && res !== null && res.status >= 400) {\n          var msg = 'cannot ' + req.method + ' ' + req.url + ' (' + res.status + ')';\n          error = new SuperagentPromiseError(msg);\n          error.status = res.status;\n          error.body = res.body;\n          error.res = res;\n          reject(error);\n        } else if (err) {\n          reject(new SuperagentPromiseError('Bad request', err));\n        } else {\n          resolve(res);\n        }\n      });\n\n      if (typeof onCancel === 'function') {\n        onCancel(function() {\n          req.abort();\n        });\n      }\n    });\n};\n\n/**\n *\n * Make superagent requests Promises ES6 conformant\n *\n * Call .then([onFulfilled], [onRejected]) to register callbacks\n *\n * @method then\n * @param {function} [onFulfilled]\n * @param {function} [onRejected]\n * @return {Bluebird.Promise}\n */\nRequest.prototype.then = function() {\n  var promise = this.promise();\n  return promise.then.apply(promise, arguments);\n};\n\n/**\n *\n * Make superagent requests Promises ES6 conformant\n *\n * Call .catch([onRejected]) to register callback\n *\n * @method catch\n * @param {function} [onRejected]\n * @return {Bluebird.Promise}\n */\nRequest.prototype.catch = function() {\n  var promise = this.promise();\n  return promise.catch.apply(promise, arguments);\n};\n"]}