{"version":3,"sources":["tools/Suggest/index.js"],"names":["React","require","searchIcon","refreshIcon","timer","Suggest","createClass","getInitialState","list","inputValue","label","props","defaultValue","getDefaultProps","disKey","coverLabel","componentWillReceiveProps","setState","handleClick","item","labelKey","trigger","param","lKey","debounce","value","wait","clearTimeout","setTimeout","handleCallback","handleChange","e","target","reset","loading","promise","setList","then","removeLabel","stopPropagation","event","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","render","hasList","state","length","wrapClass","placeholder","template","map","i","bind","module","exports"],"mappings":"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","file":"index.js","sourceRoot":"/Users/liangdong06/work/react-tools","sourcesContent":["/**\n * @file suggest\n * @description RT\n * @author liangdong06\n */\n\nconst React = require('react');\nconst searchIcon = require('./search.png');\nconst refreshIcon = require('./refresh.png');\nrequire('./Suggest.less');\n\nlet timer = null;\n\nconst Suggest = React.createClass({\n    getInitialState() {\n        return {\n            list: [],\n            inputValue: '',\n            label: this.props.defaultValue || ''\n        };\n    },\n    getDefaultProps() {\n        return {\n            disKey: 'name',\n            coverLabel: true\n        };\n    },\n    componentWillReceiveProps(props) {\n        this.setState({\n            inputValue: '',\n            label: props.defaultValue || ''\n        });\n    },\n    handleClick(item) {\n        const {labelKey, disKey, coverLabel, trigger, param} = this.props;\n        const lKey = labelKey || disKey;\n\n        this.setState({\n            label: item[lKey],\n            // inputValue: !coverLabel ? item[lKey] : '',\n            list: []\n        });\n\n        if (trigger) {\n            // let param = param || {};\n            this.props.trigger(item, param);\n        }\n    },\n    // 去抖\n    debounce(value) {\n        let wait = this.props.wait || 300;\n        clearTimeout(timer);\n        timer = setTimeout(() => {\n            this.handleCallback(value);\n        }, wait);\n    },\n    handleChange(e) {\n        let value = e.target.value;\n        this.setState({\n            inputValue: value\n        });\n        if (!value) {\n            this.reset();\n            return;\n        }\n        this.debounce(value);\n    },\n    handleCallback(value) {\n        this.setState({\n            loading: true\n        });\n        let promise = this.props.handleChange(value, this.setList);\n        if (promise && typeof promise.then === 'function') {\n            promise.then(list => {\n                this.setList(list);\n            });\n        }\n    },\n    removeLabel() {\n        this.setState({\n            label: '',\n            inputValue: ''\n        });\n        if (this.props.removeLabel) {\n            this.props.removeLabel();\n        }\n    },\n    setList(list) {\n        this.setState({\n            loading: false,\n            list\n        });\n    },\n    stopPropagation(event) {\n        event.stopPropagation();\n    },\n    componentDidMount() {\n        window.addEventListener('click', this.reset, false);\n    },\n    componentWillUnmount() {\n        window.removeEventListener('click', this.reset, false);\n    },\n    reset() {\n        this.setState({\n            list: []\n        });\n        clearTimeout(timer);\n    },\n    render() {\n        let hasList = this.state.list.length;\n        let wrapClass = 'befe-suggest ' + (hasList ? 'show' : '');\n        const {disKey, coverLabel, placeholder, template} = this.props;\n\n        return (\n            <div className={wrapClass} onClick={this.stopPropagation} >\n                <div className=\"suggest-outer\">\n                    {\n                        coverLabel && this.state.label\n                        ? (<div className=\"suggest-label\" >\n                        <span className=\"suggest-label-text\" >{this.state.label}</span>\n                        <span onClick={this.removeLabel} className=\"suggest-icon suggest-close\"></span>\n                        </div>)\n                        : null\n                    }\n                    <input className=\"suggest-input\"\n                        value={this.state.inputValue}\n                        type=\"text\" placeholder={placeholder || ''}\n                        onChange={this.handleChange} />\n                    {\n                        this.state.loading ? <span className=\"suggest-icon refresh fa-spin\"></span>\n                        : <span className=\"suggest-icon search\"></span>\n                    }\n                </div>\n                {\n                    hasList\n                    ? <div className=\"suggest-hidden\" >\n                        <div className=\"suggest-inner\" >\n                            <div className=\"suggest-list\" >\n                                {\n                                    this.state.list.map((item, i) => {\n                                        return template\n                                        ? template(item, i, this.handleClick.bind(this, item))\n                                        : (<div\n                                                className=\"suggest-li\"\n                                                key={i}\n                                                onClick={this.handleClick.bind(this, item)} >\n                                            {item[disKey]}\n                                        </div>);\n                                    })\n                                }\n                            </div>\n                        </div>\n                    </div>\n                    : null\n                }\n            </div>\n        );\n    }\n});\n\n\nmodule.exports = Suggest;\n"]}