{"version":3,"sources":["node_modules/react/lib/SelectEventPlugin.js"],"names":["EventConstants","require","EventPropagators","ExecutionEnvironment","ReactDOMComponentTree","ReactInputSelection","SyntheticEvent","getActiveElement","isTextInputElement","keyOf","shallowEqual","topLevelTypes","skipSelectionChangeEvent","canUseDOM","document","documentMode","eventTypes","select","phasedRegistrationNames","bubbled","onSelect","captured","onSelectCapture","dependencies","topBlur","topContextMenu","topFocus","topKeyDown","topKeyUp","topMouseDown","topMouseUp","topSelectionChange","activeElement","activeElementInst","lastSelection","mouseDown","hasListener","ON_SELECT_KEY","getSelection","node","hasSelectionCapabilities","start","selectionStart","end","selectionEnd","window","selection","anchorNode","anchorOffset","focusNode","focusOffset","range","createRange","parentElement","text","top","boundingTop","left","boundingLeft","constructSelectEvent","nativeEvent","nativeEventTarget","currentSelection","syntheticEvent","getPooled","type","target","accumulateTwoPhaseDispatches","SelectEventPlugin","extractEvents","topLevelType","targetInst","targetNode","getNodeFromInstance","contentEditable","didPutListener","inst","registrationName","listener","module","exports"],"mappings":"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","file":"SelectEventPlugin.js","sourceRoot":"/Users/liangdong06/work/react-tools","sourcesContent":["/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule SelectEventPlugin\n */\n\n'use strict';\n\nvar EventConstants = require('./EventConstants');\nvar EventPropagators = require('./EventPropagators');\nvar ExecutionEnvironment = require('fbjs/lib/ExecutionEnvironment');\nvar ReactDOMComponentTree = require('./ReactDOMComponentTree');\nvar ReactInputSelection = require('./ReactInputSelection');\nvar SyntheticEvent = require('./SyntheticEvent');\n\nvar getActiveElement = require('fbjs/lib/getActiveElement');\nvar isTextInputElement = require('./isTextInputElement');\nvar keyOf = require('fbjs/lib/keyOf');\nvar shallowEqual = require('fbjs/lib/shallowEqual');\n\nvar topLevelTypes = EventConstants.topLevelTypes;\n\nvar skipSelectionChangeEvent = ExecutionEnvironment.canUseDOM && 'documentMode' in document && document.documentMode <= 11;\n\nvar eventTypes = {\n  select: {\n    phasedRegistrationNames: {\n      bubbled: keyOf({ onSelect: null }),\n      captured: keyOf({ onSelectCapture: null })\n    },\n    dependencies: [topLevelTypes.topBlur, topLevelTypes.topContextMenu, topLevelTypes.topFocus, topLevelTypes.topKeyDown, topLevelTypes.topKeyUp, topLevelTypes.topMouseDown, topLevelTypes.topMouseUp, topLevelTypes.topSelectionChange]\n  }\n};\n\nvar activeElement = null;\nvar activeElementInst = null;\nvar lastSelection = null;\nvar mouseDown = false;\n\n// Track whether a listener exists for this plugin. If none exist, we do\n// not extract events. See #3639.\nvar hasListener = false;\nvar ON_SELECT_KEY = keyOf({ onSelect: null });\n\n/**\n * Get an object which is a unique representation of the current selection.\n *\n * The return value will not be consistent across nodes or browsers, but\n * two identical selections on the same node will return identical objects.\n *\n * @param {DOMElement} node\n * @return {object}\n */\nfunction getSelection(node) {\n  if ('selectionStart' in node && ReactInputSelection.hasSelectionCapabilities(node)) {\n    return {\n      start: node.selectionStart,\n      end: node.selectionEnd\n    };\n  } else if (window.getSelection) {\n    var selection = window.getSelection();\n    return {\n      anchorNode: selection.anchorNode,\n      anchorOffset: selection.anchorOffset,\n      focusNode: selection.focusNode,\n      focusOffset: selection.focusOffset\n    };\n  } else if (document.selection) {\n    var range = document.selection.createRange();\n    return {\n      parentElement: range.parentElement(),\n      text: range.text,\n      top: range.boundingTop,\n      left: range.boundingLeft\n    };\n  }\n}\n\n/**\n * Poll selection to see whether it's changed.\n *\n * @param {object} nativeEvent\n * @return {?SyntheticEvent}\n */\nfunction constructSelectEvent(nativeEvent, nativeEventTarget) {\n  // Ensure we have the right element, and that the user is not dragging a\n  // selection (this matches native `select` event behavior). In HTML5, select\n  // fires only on input and textarea thus if there's no focused element we\n  // won't dispatch.\n  if (mouseDown || activeElement == null || activeElement !== getActiveElement()) {\n    return null;\n  }\n\n  // Only fire when selection has actually changed.\n  var currentSelection = getSelection(activeElement);\n  if (!lastSelection || !shallowEqual(lastSelection, currentSelection)) {\n    lastSelection = currentSelection;\n\n    var syntheticEvent = SyntheticEvent.getPooled(eventTypes.select, activeElementInst, nativeEvent, nativeEventTarget);\n\n    syntheticEvent.type = 'select';\n    syntheticEvent.target = activeElement;\n\n    EventPropagators.accumulateTwoPhaseDispatches(syntheticEvent);\n\n    return syntheticEvent;\n  }\n\n  return null;\n}\n\n/**\n * This plugin creates an `onSelect` event that normalizes select events\n * across form elements.\n *\n * Supported elements are:\n * - input (see `isTextInputElement`)\n * - textarea\n * - contentEditable\n *\n * This differs from native browser implementations in the following ways:\n * - Fires on contentEditable fields as well as inputs.\n * - Fires for collapsed selection.\n * - Fires after user input.\n */\nvar SelectEventPlugin = {\n\n  eventTypes: eventTypes,\n\n  extractEvents: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) {\n    if (!hasListener) {\n      return null;\n    }\n\n    var targetNode = targetInst ? ReactDOMComponentTree.getNodeFromInstance(targetInst) : window;\n\n    switch (topLevelType) {\n      // Track the input node that has focus.\n      case topLevelTypes.topFocus:\n        if (isTextInputElement(targetNode) || targetNode.contentEditable === 'true') {\n          activeElement = targetNode;\n          activeElementInst = targetInst;\n          lastSelection = null;\n        }\n        break;\n      case topLevelTypes.topBlur:\n        activeElement = null;\n        activeElementInst = null;\n        lastSelection = null;\n        break;\n\n      // Don't fire the event while the user is dragging. This matches the\n      // semantics of the native select event.\n      case topLevelTypes.topMouseDown:\n        mouseDown = true;\n        break;\n      case topLevelTypes.topContextMenu:\n      case topLevelTypes.topMouseUp:\n        mouseDown = false;\n        return constructSelectEvent(nativeEvent, nativeEventTarget);\n\n      // Chrome and IE fire non-standard event when selection is changed (and\n      // sometimes when it hasn't). IE's event fires out of order with respect\n      // to key and input events on deletion, so we discard it.\n      //\n      // Firefox doesn't support selectionchange, so check selection status\n      // after each key entry. The selection changes after keydown and before\n      // keyup, but we check on keydown as well in the case of holding down a\n      // key, when multiple keydown events are fired but only one keyup is.\n      // This is also our approach for IE handling, for the reason above.\n      case topLevelTypes.topSelectionChange:\n        if (skipSelectionChangeEvent) {\n          break;\n        }\n      // falls through\n      case topLevelTypes.topKeyDown:\n      case topLevelTypes.topKeyUp:\n        return constructSelectEvent(nativeEvent, nativeEventTarget);\n    }\n\n    return null;\n  },\n\n  didPutListener: function (inst, registrationName, listener) {\n    if (registrationName === ON_SELECT_KEY) {\n      hasListener = true;\n    }\n  }\n};\n\nmodule.exports = SelectEventPlugin;"]}