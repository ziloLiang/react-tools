{"version":3,"sources":["node_modules/core-js/modules/es6.promise.js"],"names":["LIBRARY","require","global","ctx","classof","$export","isObject","aFunction","anInstance","forOf","speciesConstructor","task","set","microtask","PROMISE","TypeError","process","$Promise","isNode","empty","Internal","GenericPromiseCapability","Wrapper","USE_NATIVE","promise","resolve","FakePromise","constructor","exec","PromiseRejectionEvent","then","e","sameConstructor","a","b","isThenable","it","newPromiseCapability","C","PromiseCapability","reject","$$resolve","$$reject","undefined","perform","error","notify","isReject","_n","chain","_c","value","_v","ok","_s","i","run","reaction","handler","fail","domain","result","_h","onHandleUnhandled","enter","exit","call","length","onUnhandled","abrupt","console","isUnhandled","emit","onunhandledrejection","reason","_a","onrejectionhandled","$reject","_d","_w","slice","$resolve","wrapper","Promise","executor","err","prototype","onFulfilled","onRejected","push","G","W","F","S","r","capability","x","iter","all","iterable","values","index","remaining","$index","alreadyCalled","race"],"mappings":"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","file":"es6.promise.js","sourceRoot":"/Users/liangdong06/work/react-tools","sourcesContent":["'use strict';\nvar LIBRARY            = require('./_library')\n  , global             = require('./_global')\n  , ctx                = require('./_ctx')\n  , classof            = require('./_classof')\n  , $export            = require('./_export')\n  , isObject           = require('./_is-object')\n  , aFunction          = require('./_a-function')\n  , anInstance         = require('./_an-instance')\n  , forOf              = require('./_for-of')\n  , speciesConstructor = require('./_species-constructor')\n  , task               = require('./_task').set\n  , microtask          = require('./_microtask')()\n  , PROMISE            = 'Promise'\n  , TypeError          = global.TypeError\n  , process            = global.process\n  , $Promise           = global[PROMISE]\n  , process            = global.process\n  , isNode             = classof(process) == 'process'\n  , empty              = function(){ /* empty */ }\n  , Internal, GenericPromiseCapability, Wrapper;\n\nvar USE_NATIVE = !!function(){\n  try {\n    // correct subclassing with @@species support\n    var promise     = $Promise.resolve(1)\n      , FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function(exec){ exec(empty, empty); };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function') && promise.then(empty) instanceof FakePromise;\n  } catch(e){ /* empty */ }\n}();\n\n// helpers\nvar sameConstructor = function(a, b){\n  // with library wrapper special case\n  return a === b || a === $Promise && b === Wrapper;\n};\nvar isThenable = function(it){\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar newPromiseCapability = function(C){\n  return sameConstructor($Promise, C)\n    ? new PromiseCapability(C)\n    : new GenericPromiseCapability(C);\n};\nvar PromiseCapability = GenericPromiseCapability = function(C){\n  var resolve, reject;\n  this.promise = new C(function($$resolve, $$reject){\n    if(resolve !== undefined || reject !== undefined)throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject  = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject  = aFunction(reject);\n};\nvar perform = function(exec){\n  try {\n    exec();\n  } catch(e){\n    return {error: e};\n  }\n};\nvar notify = function(promise, isReject){\n  if(promise._n)return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function(){\n    var value = promise._v\n      , ok    = promise._s == 1\n      , i     = 0;\n    var run = function(reaction){\n      var handler = ok ? reaction.ok : reaction.fail\n        , resolve = reaction.resolve\n        , reject  = reaction.reject\n        , domain  = reaction.domain\n        , result, then;\n      try {\n        if(handler){\n          if(!ok){\n            if(promise._h == 2)onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if(handler === true)result = value;\n          else {\n            if(domain)domain.enter();\n            result = handler(value);\n            if(domain)domain.exit();\n          }\n          if(result === reaction.promise){\n            reject(TypeError('Promise-chain cycle'));\n          } else if(then = isThenable(result)){\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch(e){\n        reject(e);\n      }\n    };\n    while(chain.length > i)run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if(isReject && !promise._h)onUnhandled(promise);\n  });\n};\nvar onUnhandled = function(promise){\n  task.call(global, function(){\n    var value = promise._v\n      , abrupt, handler, console;\n    if(isUnhandled(promise)){\n      abrupt = perform(function(){\n        if(isNode){\n          process.emit('unhandledRejection', value, promise);\n        } else if(handler = global.onunhandledrejection){\n          handler({promise: promise, reason: value});\n        } else if((console = global.console) && console.error){\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if(abrupt)throw abrupt.error;\n  });\n};\nvar isUnhandled = function(promise){\n  if(promise._h == 1)return false;\n  var chain = promise._a || promise._c\n    , i     = 0\n    , reaction;\n  while(chain.length > i){\n    reaction = chain[i++];\n    if(reaction.fail || !isUnhandled(reaction.promise))return false;\n  } return true;\n};\nvar onHandleUnhandled = function(promise){\n  task.call(global, function(){\n    var handler;\n    if(isNode){\n      process.emit('rejectionHandled', promise);\n    } else if(handler = global.onrejectionhandled){\n      handler({promise: promise, reason: promise._v});\n    }\n  });\n};\nvar $reject = function(value){\n  var promise = this;\n  if(promise._d)return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if(!promise._a)promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function(value){\n  var promise = this\n    , then;\n  if(promise._d)return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if(promise === value)throw TypeError(\"Promise can't be resolved itself\");\n    if(then = isThenable(value)){\n      microtask(function(){\n        var wrapper = {_w: promise, _d: false}; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch(e){\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch(e){\n    $reject.call({_w: promise, _d: false}, e); // wrap\n  }\n};\n\n// constructor polyfill\nif(!USE_NATIVE){\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor){\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch(err){\n      $reject.call(this, err);\n    }\n  };\n  Internal = function Promise(executor){\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected){\n      var reaction    = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok     = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail   = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if(this._a)this._a.push(reaction);\n      if(this._s)notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function(onRejected){\n      return this.then(undefined, onRejected);\n    }\n  });\n  PromiseCapability = function(){\n    var promise  = new Internal;\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject  = ctx($reject, promise, 1);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Promise: $Promise});\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r){\n    var capability = newPromiseCapability(this)\n      , $$reject   = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x){\n    // instanceof instead of internal slot check because we should fix it without replacement native Promise core\n    if(x instanceof $Promise && sameConstructor(x.constructor, this))return x;\n    var capability = newPromiseCapability(this)\n      , $$resolve  = capability.resolve;\n    $$resolve(x);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function(iter){\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable){\n    var C          = this\n      , capability = newPromiseCapability(C)\n      , resolve    = capability.resolve\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      var values    = []\n        , index     = 0\n        , remaining = 1;\n      forOf(iterable, false, function(promise){\n        var $index        = index++\n          , alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function(value){\n          if(alreadyCalled)return;\n          alreadyCalled  = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable){\n    var C          = this\n      , capability = newPromiseCapability(C)\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      forOf(iterable, false, function(promise){\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  }\n});"]}