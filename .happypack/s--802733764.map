{"version":3,"sources":["node_modules/superagent/lib/request-base.js"],"names":["isObject","require","exports","clearTimeout","_clearTimeout","_timeout","_timer","parse","fn","_parser","serialize","_serializer","timeout","ms","then","resolve","reject","_fullfilledPromise","self","Promise","innerResolve","innerReject","end","err","res","catch","cb","undefined","use","get","field","_header","toLowerCase","getHeader","set","val","key","header","unset","name","Error","_getFormData","append","abort","_aborted","xhr","req","emit","withCredentials","_withCredentials","redirects","n","_maxRedirects","toJSON","method","url","data","_data","headers","_isHost","obj","str","toString","call","send","type"],"mappings":";;AAAA;;;AAGA,IAAIA,WAAWC,QAAQ,aAAR,CAAf;;AAEA;;;;;;;AAOAC,QAAQC,YAAR,GAAuB,SAASC,aAAT,GAAwB;AAC7C,OAAKC,QAAL,GAAgB,CAAhB;AACAF,eAAa,KAAKG,MAAlB;AACA,SAAO,IAAP;AACD,CAJD;;AAMA;;;;;;;;;AASAJ,QAAQK,KAAR,GAAgB,SAASA,KAAT,CAAeC,EAAf,EAAkB;AAChC,OAAKC,OAAL,GAAeD,EAAf;AACA,SAAO,IAAP;AACD,CAHD;;AAKA;;;;;;;;;AASAN,QAAQQ,SAAR,GAAoB,SAASA,SAAT,CAAmBF,EAAnB,EAAsB;AACxC,OAAKG,WAAL,GAAmBH,EAAnB;AACA,SAAO,IAAP;AACD,CAHD;;AAKA;;;;;;;;AAQAN,QAAQU,OAAR,GAAkB,SAASA,OAAT,CAAiBC,EAAjB,EAAoB;AACpC,OAAKR,QAAL,GAAgBQ,EAAhB;AACA,SAAO,IAAP;AACD,CAHD;;AAKA;;;;;;;;AAQAX,QAAQY,IAAR,GAAe,SAASA,IAAT,CAAcC,OAAd,EAAuBC,MAAvB,EAA+B;AAC5C,MAAI,CAAC,KAAKC,kBAAV,EAA8B;AAC5B,QAAIC,OAAO,IAAX;AACA,SAAKD,kBAAL,GAA0B,IAAIE,OAAJ,CAAY,UAASC,YAAT,EAAuBC,WAAvB,EAAmC;AACvEH,WAAKI,GAAL,CAAS,UAASC,GAAT,EAAcC,GAAd,EAAkB;AACzB,YAAID,GAAJ,EAASF,YAAYE,GAAZ,EAAT,KAAgCH,aAAaI,GAAb;AACjC,OAFD;AAGD,KAJyB,CAA1B;AAKD;AACD,SAAO,KAAKP,kBAAL,CAAwBH,IAAxB,CAA6BC,OAA7B,EAAsCC,MAAtC,CAAP;AACD,CAVD;;AAYAd,QAAQuB,KAAR,GAAgB,UAASC,EAAT,EAAa;AAC3B,SAAO,KAAKZ,IAAL,CAAUa,SAAV,EAAqBD,EAArB,CAAP;AACD,CAFD;;AAIA;;;;AAIAxB,QAAQ0B,GAAR,GAAc,SAASA,GAAT,CAAapB,EAAb,EAAiB;AAC7BA,KAAG,IAAH;AACA,SAAO,IAAP;AACD,CAHD;;AAMA;;;;;;;;;AASAN,QAAQ2B,GAAR,GAAc,UAASC,KAAT,EAAe;AAC3B,SAAO,KAAKC,OAAL,CAAaD,MAAME,WAAN,EAAb,CAAP;AACD,CAFD;;AAIA;;;;;;;;;;;;AAYA9B,QAAQ+B,SAAR,GAAoB/B,QAAQ2B,GAA5B;;AAEA;;;;;;;;;;;;;;;;;;;;;AAqBA3B,QAAQgC,GAAR,GAAc,UAASJ,KAAT,EAAgBK,GAAhB,EAAoB;AAChC,MAAInC,SAAS8B,KAAT,CAAJ,EAAqB;AACnB,SAAK,IAAIM,GAAT,IAAgBN,KAAhB,EAAuB;AACrB,WAAKI,GAAL,CAASE,GAAT,EAAcN,MAAMM,GAAN,CAAd;AACD;AACD,WAAO,IAAP;AACD;AACD,OAAKL,OAAL,CAAaD,MAAME,WAAN,EAAb,IAAoCG,GAApC;AACA,OAAKE,MAAL,CAAYP,KAAZ,IAAqBK,GAArB;AACA,SAAO,IAAP;AACD,CAVD;;AAYA;;;;;;;;;;;;AAYAjC,QAAQoC,KAAR,GAAgB,UAASR,KAAT,EAAe;AAC7B,SAAO,KAAKC,OAAL,CAAaD,MAAME,WAAN,EAAb,CAAP;AACA,SAAO,KAAKK,MAAL,CAAYP,KAAZ,CAAP;AACA,SAAO,IAAP;AACD,CAJD;;AAMA;;;;;;;;;;;;;;;;;;;AAmBA5B,QAAQ4B,KAAR,GAAgB,UAASS,IAAT,EAAeJ,GAAf,EAAoB;;AAElC;AACA,MAAI,SAASI,IAAT,IAAkBZ,cAAcY,IAApC,EAA0C;AACxC,UAAM,IAAIC,KAAJ,CAAU,yCAAV,CAAN;AACD;;AAED,MAAIxC,SAASuC,IAAT,CAAJ,EAAoB;AAClB,SAAK,IAAIH,GAAT,IAAgBG,IAAhB,EAAsB;AACpB,WAAKT,KAAL,CAAWM,GAAX,EAAgBG,KAAKH,GAAL,CAAhB;AACD;AACD,WAAO,IAAP;AACD;;AAED;AACA,MAAI,SAASD,GAAT,IAAgBR,cAAcQ,GAAlC,EAAuC;AACrC,UAAM,IAAIK,KAAJ,CAAU,wCAAV,CAAN;AACD;AACD,OAAKC,YAAL,GAAoBC,MAApB,CAA2BH,IAA3B,EAAiCJ,GAAjC;AACA,SAAO,IAAP;AACD,CApBD;;AAsBA;;;;;;AAMAjC,QAAQyC,KAAR,GAAgB,YAAU;AACxB,MAAI,KAAKC,QAAT,EAAmB;AACjB,WAAO,IAAP;AACD;AACD,OAAKA,QAAL,GAAgB,IAAhB;AACA,OAAKC,GAAL,IAAY,KAAKA,GAAL,CAASF,KAAT,EAAZ,CALwB,CAKM;AAC9B,OAAKG,GAAL,IAAY,KAAKA,GAAL,CAASH,KAAT,EAAZ,CANwB,CAMM;AAC9B,OAAKxC,YAAL;AACA,OAAK4C,IAAL,CAAU,OAAV;AACA,SAAO,IAAP;AACD,CAVD;;AAYA;;;;;;;;;;;AAWA7C,QAAQ8C,eAAR,GAA0B,YAAU;AAClC;AACA,OAAKC,gBAAL,GAAwB,IAAxB;AACA,SAAO,IAAP;AACD,CAJD;;AAMA;;;;;;;;AAQA/C,QAAQgD,SAAR,GAAoB,UAASC,CAAT,EAAW;AAC7B,OAAKC,aAAL,GAAqBD,CAArB;AACA,SAAO,IAAP;AACD,CAHD;;AAKA;;;;;;;;;AASAjD,QAAQmD,MAAR,GAAiB,YAAU;AACzB,SAAO;AACLC,YAAQ,KAAKA,MADR;AAELC,SAAK,KAAKA,GAFL;AAGLC,UAAM,KAAKC,KAHN;AAILC,aAAS,KAAK3B;AAJT,GAAP;AAMD,CAPD;;AASA;;;;;;;;;;;AAWA7B,QAAQyD,OAAR,GAAkB,SAASA,OAAT,CAAiBC,GAAjB,EAAsB;AACtC,MAAIC,MAAM,GAAGC,QAAH,CAAYC,IAAZ,CAAiBH,GAAjB,CAAV;;AAEA,UAAQC,GAAR;AACE,SAAK,eAAL;AACA,SAAK,eAAL;AACA,SAAK,mBAAL;AACE,aAAO,IAAP;AACF;AACE,aAAO,KAAP;AANJ;AAQD,CAXD;;AAaA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA3D,QAAQ8D,IAAR,GAAe,UAASR,IAAT,EAAc;AAC3B,MAAII,MAAM5D,SAASwD,IAAT,CAAV;AACA,MAAIS,OAAO,KAAKlC,OAAL,CAAa,cAAb,CAAX;;AAEA;AACA,MAAI6B,OAAO5D,SAAS,KAAKyD,KAAd,CAAX,EAAiC;AAC/B,SAAK,IAAIrB,GAAT,IAAgBoB,IAAhB,EAAsB;AACpB,WAAKC,KAAL,CAAWrB,GAAX,IAAkBoB,KAAKpB,GAAL,CAAlB;AACD;AACF,GAJD,MAIO,IAAI,YAAY,OAAOoB,IAAvB,EAA6B;AAClC;AACA,QAAI,CAACS,IAAL,EAAW,KAAKA,IAAL,CAAU,MAAV;AACXA,WAAO,KAAKlC,OAAL,CAAa,cAAb,CAAP;AACA,QAAI,uCAAuCkC,IAA3C,EAAiD;AAC/C,WAAKR,KAAL,GAAa,KAAKA,KAAL,GACT,KAAKA,KAAL,GAAa,GAAb,GAAmBD,IADV,GAETA,IAFJ;AAGD,KAJD,MAIO;AACL,WAAKC,KAAL,GAAa,CAAC,KAAKA,KAAL,IAAc,EAAf,IAAqBD,IAAlC;AACD;AACF,GAXM,MAWA;AACL,SAAKC,KAAL,GAAaD,IAAb;AACD;;AAED,MAAI,CAACI,GAAD,IAAQ,KAAKD,OAAL,CAAaH,IAAb,CAAZ,EAAgC,OAAO,IAAP;;AAEhC;AACA,MAAI,CAACS,IAAL,EAAW,KAAKA,IAAL,CAAU,MAAV;AACX,SAAO,IAAP;AACD,CA7BD","file":"request-base.js","sourceRoot":"/Users/liangdong06/work/react-tools","sourcesContent":["/**\n * Module of mixed-in functions shared between node and client code\n */\nvar isObject = require('./is-object');\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nexports.clearTimeout = function _clearTimeout(){\n  this._timeout = 0;\n  clearTimeout(this._timer);\n  return this;\n};\n\n/**\n * Override default response body parser\n *\n * This function will be called to convert incoming data into request.body\n *\n * @param {Function}\n * @api public\n */\n\nexports.parse = function parse(fn){\n  this._parser = fn;\n  return this;\n};\n\n/**\n * Override default request body serializer\n *\n * This function will be called to convert data set via .send or .attach into payload to send\n *\n * @param {Function}\n * @api public\n */\n\nexports.serialize = function serialize(fn){\n  this._serializer = fn;\n  return this;\n};\n\n/**\n * Set timeout to `ms`.\n *\n * @param {Number} ms\n * @return {Request} for chaining\n * @api public\n */\n\nexports.timeout = function timeout(ms){\n  this._timeout = ms;\n  return this;\n};\n\n/**\n * Promise support\n *\n * @param {Function} resolve\n * @param {Function} reject\n * @return {Request}\n */\n\nexports.then = function then(resolve, reject) {\n  if (!this._fullfilledPromise) {\n    var self = this;\n    this._fullfilledPromise = new Promise(function(innerResolve, innerReject){\n      self.end(function(err, res){\n        if (err) innerReject(err); else innerResolve(res);\n      });\n    });\n  }\n  return this._fullfilledPromise.then(resolve, reject);\n}\n\nexports.catch = function(cb) {\n  return this.then(undefined, cb);\n};\n\n/**\n * Allow for extension\n */\n\nexports.use = function use(fn) {\n  fn(this);\n  return this;\n}\n\n\n/**\n * Get request header `field`.\n * Case-insensitive.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nexports.get = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Get case-insensitive header `field` value.\n * This is a deprecated internal API. Use `.get(field)` instead.\n *\n * (getHeader is no longer used internally by the superagent code base)\n *\n * @param {String} field\n * @return {String}\n * @api private\n * @deprecated\n */\n\nexports.getHeader = exports.get;\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n * Case-insensitive.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nexports.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n * Case-insensitive.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n */\nexports.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Write the field `name` and `val`, or multiple fields with one object\n * for \"multipart/form-data\" request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n *\n * request.post('/upload')\n *   .field({ foo: 'bar', baz: 'qux' })\n *   .end(callback);\n * ```\n *\n * @param {String|Object} name\n * @param {String|Blob|File|Buffer|fs.ReadStream} val\n * @return {Request} for chaining\n * @api public\n */\nexports.field = function(name, val) {\n\n  // name should be either a string or an object.\n  if (null === name ||  undefined === name) {\n    throw new Error('.field(name, val) name can not be empty');\n  }\n\n  if (isObject(name)) {\n    for (var key in name) {\n      this.field(key, name[key]);\n    }\n    return this;\n  }\n\n  // val should be defined now\n  if (null === val || undefined === val) {\n    throw new Error('.field(name, val) val can not be empty');\n  }\n  this._getFormData().append(name, val);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\nexports.abort = function(){\n  if (this._aborted) {\n    return this;\n  }\n  this._aborted = true;\n  this.xhr && this.xhr.abort(); // browser\n  this.req && this.req.abort(); // node\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nexports.withCredentials = function(){\n  // This is browser-only functionality. Node side is no-op.\n  this._withCredentials = true;\n  return this;\n};\n\n/**\n * Set the max redirects to `n`. Does noting in browser XHR implementation.\n *\n * @param {Number} n\n * @return {Request} for chaining\n * @api public\n */\n\nexports.redirects = function(n){\n  this._maxRedirects = n;\n  return this;\n};\n\n/**\n * Convert to a plain javascript object (not JSON string) of scalar properties.\n * Note as this method is designed to return a useful non-this value,\n * it cannot be chained.\n *\n * @return {Object} describing method, url, and data of this request\n * @api public\n */\n\nexports.toJSON = function(){\n  return {\n    method: this.method,\n    url: this.url,\n    data: this._data,\n    headers: this._header\n  };\n};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * TODO: future proof, move to compoent land\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nexports._isHost = function _isHost(obj) {\n  var str = {}.toString.call(obj);\n\n  switch (str) {\n    case '[object File]':\n    case '[object Blob]':\n    case '[object FormData]':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Send `data` as the request body, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"}')\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n *      request.post('/user')\n *        .send('name=tobi')\n *        .send('species=ferret')\n *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nexports.send = function(data){\n  var obj = isObject(data);\n  var type = this._header['content-type'];\n\n  // merge\n  if (obj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    // default to x-www-form-urlencoded\n    if (!type) this.type('form');\n    type = this._header['content-type'];\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!obj || this._isHost(data)) return this;\n\n  // default to json\n  if (!type) this.type('json');\n  return this;\n};\n"]}